
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Cantong v1 Demo</title>
  <style>
    body{font-family:system-ui,Arial;margin:20px;max-width:720px}
    .card{border:1px solid #ddd;border-radius:12px;padding:16px;margin-top:12px}
    .row{display:flex;gap:8px;align-items:center}
    button{padding:6px 10px;border-radius:8px;border:1px solid #ccc;background:#f8f8f8;cursor:pointer}
    input{flex:1;padding:10px;border-radius:8px;border:1px solid #ccc}
    .dot{width:10px;height:10px;border-radius:50%}
    .dot.green{background:#11a36a}.dot.yellow{background:#f3b700}.dot.gray{background:#9aa0a6}
    small{color:#666}
  </style>
</head>
<body>
  <h1>Cantong v1</h1>
  <div class="row">
    <input id="q" placeholder="è¼¸å…¥ï¼šæ—©æŠ– / å¥½æ”° / rest early / æ—©ç‚¹ä¼‘æ¯">
    <select id="lang">
      <option value="zhh">ç²µèª</option>
      <option value="chs">ä¸­æ–‡</option>
      <option value="en">English</option>
    </select>
    <button onclick="lookup()">æŸ¥</button>
  </div>
  <div id="out"></div>
<script>
async function lookup(){
  const q = document.getElementById('q').value.trim();
  const lang = document.getElementById('lang').value;
  if(!q) return;
  const res = await fetch(`/api/route?fn=lookup&q=${encodeURIComponent(q)}&lang=${lang}`);
  const data = await res.json();
  const out = document.getElementById('out');
  out.innerHTML = '';
  const card = document.createElement('div'); card.className='card';
  const dotClass = data.normalize?.suggestion && data.normalize.suggestion !== data.query ? 'yellow' : (data.best ? 'green':'gray');
  card.innerHTML = `
    <div class="row"><div class="dot ${dotClass}"></div><strong>çµæœ</strong></div>
    <div style="margin-top:8px">
      ${data.best ? `<div><b>ç²µèªæ­£å¯«</b>ï¼š${data.best.headword} <button onclick="speak('${(data.best.headword||'').replace(/'/g,'')}')">ğŸ”Š</button></div>` : `<div>æœªæ”¶éŒ„</div>`}
      ${data.best?.senses?.[0]?.gloss_chs ? `<div><b>ä¸­æ–‡</b>ï¼š${data.best.senses[0].gloss_chs}</div>`:''}
      ${data.best?.senses?.[0]?.gloss_en ? `<div><b>English</b>ï¼š${data.best.senses[0].gloss_en}</div>`:''}
      ${data.normalize?.suggestion ? `<div><b>ç³¾éŒ¯</b>ï¼šä½ è¦æ‰¾çš„æ˜¯ <u>${data.normalize.suggestion}</u></div>`:''}
      <div style="margin-top:6px"><small>å€™é¸ï¼š${(data.candidates||[]).map(c=>c.headword).slice(0,5).join('ã€')||'â€”'}</small></div>
    </div>`;
  out.appendChild(card);
}
function speak(text){
  const u = new SpeechSynthesisUtterance(text);
  u.lang = 'zh-HK'; speechSynthesis.speak(u);
}
</script>
</body>
</html>
