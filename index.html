<!doctype html>
<html lang="zh-HK">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Can-Tong · 中英粵 互通 Demo</title>
  <style>
    :root{--bg:#0b0d10;--panel:#12161b;--muted:#9aa4af;--text:#e6edf3;--accent:#6ea8fe;--ok:#30d158;--warn:#ffd60a;}
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,'Apple Color Emoji','Segoe UI Emoji';background:var(--bg);color:var(--text)}
    header{padding:16px 20px;border-bottom:1px solid #1e2430;background:var(--panel);position:sticky;top:0;z-index:10}
    header h1{margin:0;font-size:18px;letter-spacing:0.5px}
    main{max-width:980px;margin:0 auto;padding:20px;display:grid;gap:16px}
    .card{background:var(--panel);border:1px solid #1e2430;border-radius:16px;padding:16px}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .row > *{flex:1}
    textarea{width:100%;min-height:120px;background:#0f1318;color:var(--text);border:1px solid #1e2430;border-radius:12px;padding:12px;font-size:15px;resize:vertical}
    input[type="text"], input[type="url"]{width:100%;background:#0f1318;color:var(--text);border:1px solid #1e2430;border-radius:10px;padding:10px;font-size:14px}
    label{font-size:12px;color:var(--muted);display:block;margin-bottom:6px}
    button{background:#191f2a;color:var(--text);border:1px solid #2a3342;border-radius:12px;padding:10px 14px;font-size:14px;cursor:pointer}
    button:hover{border-color:#3c4960}
    .pill{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:#0f1318;border:1px solid #263042;color:var(--muted);font-size:12px}
    .muted{color:var(--muted);font-size:12px}
    .actions{display:flex;gap:10px;flex-wrap:wrap}
    audio{width:100%}
    .small{font-size:12px}
    .ok{color:var(--ok)} .warn{color:var(--warn)}
    .lang{display:flex;gap:8px;flex-wrap:wrap}
    .lang select{background:#0f1318;color:var(--text);border:1px solid #1e2430;border-radius:10px;padding:8px}
    .grid{display:grid;gap:12px}
    @media (min-width:820px){ .grid{grid-template-columns:1.2fr .8fr} }
  </style>
</head>
<body>
  <header>
    <h1>Can‑Tong · 中英粵 互通（最小集成 Demo）</h1>
  </header>
  <main>
    <section class="card grid">
      <div>
        <label>输入（可中/英/粵混说；或直接键入文本）</label>
        <textarea id="inputText" placeholder="例：Don't push me，唔好掂我…"></textarea>
        <div class="actions" style="margin-top:10px">
          <button id="btnMic">🎙️ 录音识别（ASR）</button>
          <button id="btnStop" disabled>⏹️ 停止</button>
          <span class="pill" id="asrState">ASR：<b>未连接</b></span>
        </div>
      </div>
      <div>
        <label>目标语言</label>
        <div class="lang">
          <select id="sourceLang">
            <option value="auto">自动检测</option>
            <option value="en">英语 en</option>
            <option value="zh">中文 zh</option>
            <option value="yue_Hant">粵語繁體 yue_Hant</option>
          </select>
          <span>→</span>
          <select id="targetLang">
            <option value="yue_Hant" selected>粵語繁體 yue_Hant</option>
            <option value="en">英语 en</option>
            <option value="zh">中文 zh</option>
          </select>
        </div>
        <div class="actions" style="margin-top:10px">
          <button id="btnTranslate">🔁 翻译/粵語化</button>
          <span class="pill" id="mtState">MT：<b>未连接</b></span>
        </div>
      </div>
    </section>

    <section class="card">
      <label>输出</label>
      <textarea id="outputText" readonly></textarea>
      <div class="actions" style="margin-top:10px">
        <button id="btnSpeak">🔊 播报（TTS）</button>
        <audio id="audio" controls></audio>
        <span class="pill" id="ttsState">TTS：<b>未连接</b></span>
      </div>
      <div class="muted small" style="margin-top:8px">
        提示：如果未配置后端，将自动使用浏览器内置的 zh‑HK 语音合成进行演示（音色因系统而异）。
      </div>
    </section>

    <section class="card">
      <label>后端配置（可留空走浏览器 Demo）</label>
      <div class="row">
        <div>
          <label>ASR API（POST /api/asr，multipart: file）</label>
          <input id="asrURL" type="url" placeholder="例如：https://your-domain/api/asr">
        </div>
        <div>
          <label>翻译 API（POST /api/translate，JSON）</label>
          <input id="mtURL" type="url" placeholder="例如：https://your-domain/api/translate">
        </div>
        <div>
          <label>TTS API（POST /api/tts，JSON）</label>
          <input id="ttsURL" type="url" placeholder="例如：https://your-domain/api/tts">
        </div>
      </div>
      <div class="muted small" style="margin-top:8px">
        统一协议：<code>/api/asr</code> ⇒ {"text": "..."}；<code>/api/translate</code> ⇒ {"text","source_lang","target_lang"}；
        <code>/api/tts</code> ⇒ 返回 audio/mpeg。全部 CORS: *</div>
    </section>

    <section class="card">
      <div class="muted small">
        © 2025 Can‑Tong. 此 Demo 支持：SenseVoice / DL‑Translate (yue_Hant) / CosyVoice2；均可替换或微调。
      </div>
    </section>
  </main>

  <script src="./app.js"></script>
</body>
</html>
